<!-- Log-In-Form -->
<!-- Collects data from a (existing) user to authenticate -->


<!-- Header contains... (f.l.t.r.) -->
<!-- 1) Back button to return to StartPage  -->
<!-- 2) Page title -->
<!-- 3) Login-Button which doesn't do anything  -->
<!-- 4) SignUp Button to change to SignupPage -->
<ion-header>
  <ion-toolbar color="primary">
    <ion-button href = "/start" color="secondary" style="position: absolute; left: 5px; top: 6px ">
      <ion-back-button defaultHref="/start" style="size: 20px"></ion-back-button>
    </ion-button>
    <ion-title style="position: absolute; left: 80px; top: 15px; color: darkgreen"> Log in </ion-title>
    <ion-button color="medium"  style="position: absolute; right: 5px; top: 6px;" > Log In </ion-button>
    <ion-button color="secondary" style="position: absolute; right: 95px; top: 6px" href="/start/signup"> Sign Up
    </ion-button>
  </ion-toolbar>
</ion-header>


<ion-infinite-scroll-content style="position: absolute; top: 60px; left: 10px; right: 10px">
  <form #loginForm ="ngForm">
    <div class="form-group">
      <ion-item>
        <ion-label position="floating">E-mail address </ion-label>
        <ion-input type="email" required pattern="(.)*@(.)*" class="form-control" name="email" [(ngModel)]="email"> </ion-input>
      </ion-item>
    </div>


    <div class="form-group">
      <ion-item>
        <ion-label position="floating">Password </ion-label>
        <ion-input type="password" required class="form-control" name="password" [(ngModel)]="password" (keyup.enter)="logIn()"> </ion-input>
      </ion-item>
    </div>
  </form>

  <ion-button color="secondary" [hidden]="loading" (click)="logIn()"> Log In</ion-button>

  <!-- User feedback while trying to log in -->
  <div>
    <p *ngIf="loading"> Trying to log in </p>
    <ion-progress-bar *ngIf="loading" type="indeterminate" color="tertiary"></ion-progress-bar>
  </div>

  <!-- Handling common errors after trying to log in -->
  <div>
    <small [class.ion-hide]="isValidCombination" style="color: darkred"> Invalid email address or password. </small>
    <ion-button color="secondary" [class.ion-hide]="isValidCombination" (click)="resetPassword()"> Forgot password
    </ion-button>
    <small [class.ion-hide]="isVerified || mailSent" style="color: darkred"> Email address is not verified yet. Please
      check your emails. </small>
    <ion-button color="secondary" [class.ion-hide]="isVerified || mailSent" (click)="sendMailAgain()"> Send mail again
    </ion-button>
    <small *ngIf="mailSent"> Please check your emails. </small>
  </div>

  <!-- Handling unexpected errors -->
  <div>
    <small *ngIf="error" style="color: darkred"> An unexpected error occurred: {{error}}. Please try again
      later. </small>
  </div>

</ion-infinite-scroll-content>
<app-info-footer></app-info-footer>

